---
id: 1
title: How to pack shared projects into a single nuget (.nupkg) file
description: Ever get that feeling your doing too much work and missing out on too much fun? Using shared libraries helps with that and bundling them in your nugets helps even more...
created: "2022-06-06T15:02:00Z"
updated: "2022-06-06T15:02:00Z"
img: https://images.unsplash.com/photo-1649451844808-b81427e7a1f9?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80
tags: ["C#", "dotnet", "nuget", "devops"]
featured: true
---

## START()
Lets say you have a dotnet solution containg more than one project. You need to pack these projects into a single
nuget file. 

```
.
├── MySharedProject/
│   └── *.csproj
├── MySharedProject.Data/
│   └── *.Data.csproj
└── MySharedProject.sln
```


## HOW
Okay heres the result

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <!-- Your Properties Here -->
	<Name>LibraryProject</Name>
    <TargetsForTfmSpecificBuildOutput>
    $(TargetsForTfmSpecificBuildOutput);CopyProjectReferencesToPackage
    <TargetsForTfmSpecificBuildOutput>
  </PropertyGroup>

  <!-- Some other installed Nugets -->

  <ItemGroup>
    <ProjectReference  Include="..\LibraryProject.Data\LibraryProject.Data.csproj" />
  </ItemGroup>

  <ItemGroup>
	  <ProjectReference Include="..\LibraryProject.Data\LibraryProject.Data.csproj">
		  <ReferenceOutputAssembly>true</ReferenceOutputAssembly>
		  <IncludeAssets>LibraryProject.Data.dll</IncludeAssets>
	  </ProjectReference>
  </ItemGroup>
	
<Target DependsOnTargets="ResolveReferences" Name="CopyProjectReferencesToPackage">
    <ItemGroup>
      <BuildOutputInPackage Include="@(ReferenceCopyLocalPaths->WithMetadataValue('ReferenceSourceTarget', 'ProjectReference'))"/>
    </ItemGroup>
  </Target>
</Project>
```

## Deep Dives 🌊
What the !%#&@ is *[TargetsForTfmSpecificBuildOutput](https://docs.microsoft.com/en-us/nuget/reference/msbuild-targets#targetsfortfmspecificbuildoutput)*???



<div class="max-w-4xl p-4 text-gray-800 bg-white rounded-lg shadow">
  <div class="mb-2">
    <div class="h-3 text-3xl text-left text-gray-600">“</div>
    <p class="px-4 text-sm text-center text-gray-600">
      Lorem, ipsum dolor sit amet consectetur adipisicing elit. Nam obcaecati
      laudantium recusandae, debitis eum voluptatem ad, illo voluptatibus
      temporibus odio provident.
    </p>
    <div class="h-3 text-3xl text-right text-gray-600">”</div>
  </div>
</div>

<Quote />